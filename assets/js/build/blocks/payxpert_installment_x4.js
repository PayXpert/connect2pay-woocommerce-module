(()=>{"use strict";const e=window.wp.htmlEntities,t=window.wp.element,n=window.ReactJSXRuntime,{registerPaymentMethod:o}=window.wc.wcBlocksRegistry,{getSetting:s}=window.wc.wcSettings,r=s("payxpert_installment_x4_data",{}),c=(0,e.decodeEntities)(r.title);let i=!1;const a=o=>{const s=[];if(i="FR"===o.billing.billingAddress.country,r?.description&&s.push((0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,e.decodeEntities)(r.description)}},"description")),r?.seamless){const{customerToken:e,merchantToken:n,nonce:s,language:c,prefix:i}=r.seamless,{eventRegistration:a,emitResponse:l}=o,{onPaymentSetup:p}=a;(0,t.useEffect)(()=>{const e=document.querySelector('input[name="radio-control-wc-payment-method-options"]:checked')?.value;if(e!==i)return;const t=p(async()=>{const e=document.querySelector(`.payxpert-seamless-container[data-method="${i}"]`);if(!e)return{type:l.responseTypes.ERROR};const t=e.querySelector(".payxpert_nonce")?.value,n=e.querySelector(".merchantToken")?.value,o=e.querySelector(".customerToken")?.value;return t&&n&&o?{type:l.responseTypes.SUCCESS,meta:{paymentMethodData:{payxpert_nonce:t,[`${i}_merchant_token`]:n,[`${i}_customer_token`]:o}}}:{type:l.responseTypes.ERROR}});return()=>{"function"==typeof t&&t()}},[l.responseTypes,p,i]),(0,t.useEffect)(()=>{"function"==typeof window.mountPayxpertIframe&&(window.togglePlaceOrder(),window.mountPayxpertIframe(!1))},[]),(0,t.useEffect)(()=>{const e=document.querySelector("#place_order");if(!e)return;const t=e=>{const n=document.querySelector('input[name="radio-control-wc-payment-method-options"]:checked')?.value;if(n===i){e.preventDefault(),e.stopImmediatePropagation(),console.log("[PayXpert] Intercept click");const n=document.getElementById(`payxpert-internal-submit-${i}`);n&&(n.style.display="block",setTimeout(()=>{n.click(),n.style.display="none",setTimeout(()=>{const e=document.querySelector("#place_order");e&&(console.log("[PayXpert] Trigger real WooCommerce submission"),e.removeEventListener("click",t),e.click())},100)},20))}};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}},[i])}return s.length>0?(0,n.jsx)(n.Fragment,{children:s}):""},l=e=>{const{PaymentMethodLabel:t}=e.components,o="cb.png";return i?r.icons.includes(o)||r.icons.push(o):r.icons=r.icons.filter(e=>e!==o),(0,n.jsxs)("span",{style:{width:"100%"},children:[(0,n.jsx)(t,{text:c}),(0,n.jsx)(p,{})]})},p=()=>Array.isArray(r.icons)&&0!==r.icons.length?(0,n.jsx)("span",{style:{float:"right"},children:r.icons.map((e,t)=>(0,n.jsx)("img",{src:`${r.icon_path}/${e}`,style:{marginLeft:"5px",verticalAlign:"middle"},alt:e},t))}):null;o({name:"payxpert_installment_x4",label:(0,n.jsx)(l,{}),content:(0,n.jsx)(a,{}),edit:(0,n.jsx)(a,{}),canMakePayment:()=>!0,ariaLabel:c,supports:{features:r.supports}})})();